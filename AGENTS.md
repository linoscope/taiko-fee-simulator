# AGENTS.md

## E2E: Refresh Interactive Payloads + Regressions

Run from repo root:

```bash
cd /home/lin/workspace/taiko-fee-simulator
```

### 0) One-command deterministic pipeline (recommended)

```bash
npm run pipeline:deterministic
```

This runs, in order:
- interactive dataset payload generation
- core simulator tests
- Playwright visual regression tests

### 1) Refresh interactive dataset payloads

```bash
python3 script/generate_interactive_fee_uplot.py \
  --dataset "current365|data/eth_l1_fee_365d_20260206T195430Z.csv" \
  --dataset "prior365|data/eth_l1_fee_365d_20260207T042312Z.csv" \
  --dataset "year2021|data/eth_l1_fee_blocks_11565019_13916165_20260207T065924Z.csv" \
  --max-points 160000 \
  --out-js data/plots/fee_history_interactive_app.js
```

This writes:
- dataset payload files in `data/plots/` (for each dataset)

The interactive UI source files are static and not generated by this script:
- `data/plots/fee_history_interactive.html`
- `data/plots/fee_history_interactive_app.js`

### 2) Serve locally (recommended)

```bash
cd data/plots
python3 -m http.server 8000
```

Open:

- `http://127.0.0.1:8000/fee_history_interactive.html`
- Example with params:
  - `http://127.0.0.1:8000/fee_history_interactive.html?dataset=current365&min=21771899&max=24399899`

### 3) Optional sanity check

Run core tests:

```bash
cd /home/lin/workspace/taiko-fee-simulator
node --test data/plots/tests/*.test.js
```

### 4) Open Playwright visual report

```bash
npx playwright show-report "/home/lin/workspace/taiko-fee-simulator/playwright-report"
```
